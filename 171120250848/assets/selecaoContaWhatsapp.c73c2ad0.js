import{_ as p,aw as h,r as f,o as r,d as c,w as n,l as b,e as S,f as u,S as D,av as g,b8 as v,T as m,j as _,U as C,k as w,t as y,as as x}from"./index.0fffb5c9.js";const N={data(){return{contaWhats:null,lista:[],dbUsuario:h.usuario,clienteSistema:{}}},props:{standard:{type:Boolean,default:!0},filled:{type:Boolean,default:!1},outlined:{type:Boolean,default:!1},conta:{type:String,default:null}},methods:{async whatsListaConexoes(){this.lista.push({icon:"storage",label:this.clienteSistema.bancoDeDados,value:this.clienteSistema.bancoDeDados});let e;const s=await $db.empresa.ler({filtro:{ativo:!0}});for(const a of s)a.numeroDocumentoNacional&&(e?this.lista.push({icon:"business",label:(a==null?void 0:a.sigla)||(a==null?void 0:a.apelido),value:`cnpj${a.numeroDocumentoNacional.replace("/","_")||null}`}):(e="empresa",this.lista.push({icon:"business",label:(a==null?void 0:a.sigla)||(a==null?void 0:a.apelido),tipo:e,value:`cnpj${a.numeroDocumentoNacional.replace("/","_")||null}`})));const t=(await $db.contato.ler({filtros:{ativo:!0,usuario:!0}})).data.sort((a,l)=>a.nome.localeCompare(l.nome)).filter(a=>this.usuariosClienteSistema.some(l=>l.CodigoUsuario===a.codigoUsuario));e="";for(const a of t)a!=null&&a.numeroDocumentoNacional&&(e?this.lista.push({avatar:(a==null?void 0:a.imagem)||"",label:a.nome,value:`cpf${a.numeroDocumentoNacional}`}):(e="usuario",this.lista.push({avatar:(a==null?void 0:a.imagem)||"",label:a.nome,tipo:e,value:`cpf${a.numeroDocumentoNacional}`})));this.lista=Array.from(new Set(this.lista.map(JSON.stringify))).map(JSON.parse)},async emitirValorSeletor(e){this.contaWhats=e||"",this.$emit("atualizarConexao",this.contaWhats.value)}},async mounted(){var s;this.clienteSistema=JSON.parse(await localStorage.getItem("clienteSistema"))||{},this.usuariosClienteSistema=((s=(await $utils.geeksApi({listaTodosHibrido:{funcao:"B3F1E9DD-5F40-400D-ADED-45D463F674E9",table:"UsuarioPermissaoSistema",columns:["CodigoUsuario","idUsuario","CodigoClienteSistema","idClienteSistema"]}},{bancoDeDados:"GeeksPlat15A"})).data)==null?void 0:s.listaTodosHibrido).filter(o=>o.idClienteSistema===this.clienteSistema.idClienteSistema)||[],await this.whatsListaConexoes();const e=this.conta||"";if(e.substring(0,3)==="cpf"){const o=e.substring(3),t=(await $db.hibrido.lista({table:"contato",where:{numeroDocumentoNacional:o}}))[0];this.contaWhats={label:t.nome}}else if(e.substring(0,4)==="cnpj"){const o=e.substring(4).replace("_","/"),t=(await $db.hibrido.lista({table:"empresa",whereFilter:{numeroDocumentoNacional:o}}))[0];this.contaWhats={label:(t==null?void 0:t.sigla)||(t==null?void 0:t.apelido)}}else this.contaWhats={label:this.clienteSistema.bancoDeDados};this.conta||await this.emitirValorSeletor({label:this.clienteSistema.bancoDeDados,value:this.clienteSistema.bancoDeDados})}};function W(e,s,o,t,a,l){const d=f("avatar");return r(),c(x,{modelValue:a.contaWhats,"onUpdate:modelValue":[s[0]||(s[0]=i=>a.contaWhats=i),l.emitirValorSeletor],"option-label":"label","option-value":"value",options:a.lista,clearable:"",standard:o.standard,filled:o.filled,outlined:o.outlined,dense:"",label:"Conex\xE3o Whatsapp",color:"primary","options-selected-class":"text-primary","popup-content-class":"conexoesDropdown"},{option:n(i=>[i.opt.tipo?(r(),c(b,{key:0,class:"q-mx-xl q-my-xs"})):S("",!0),u(D,g(v(i.itemProps)),{default:n(()=>[u(m,{avatar:""},{default:n(()=>[i.opt.icon?(r(),c(_,{key:0,name:i.opt.icon,size:"sm"},null,8,["name"])):(r(),c(d,{key:1,imagem:i.opt.avatar,color:"#eeeeee",tamanho:"24"},null,8,["imagem"]))]),_:2},1024),u(m,null,{default:n(()=>[u(C,{class:"text-weight-medium",lines:"1"},{default:n(()=>[w(y(i.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options","standard","filled","outlined","onUpdate:modelValue"])}var U=p(N,[["render",W]]);export{U as s};
