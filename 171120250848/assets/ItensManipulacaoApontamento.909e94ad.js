import{_ as q,r as u,o as m,d as p,w as o,f as a,M as w,G as V,h as c,Q as f,i as F,k as b,I as D,J as I,as as _,j as h,at as g,e as Q,K as k,aU as C,br as P,D as v}from"./index.0fffb5c9.js";const O={data(){return{apontamento:{dataIni:new Date,dataFim:$utils.dataAtual(),equipamento:null,operador:null,quantidade:0,peso:0},dataIni:new Date,dataFim:new Date,horaIni:new Date,horaFim:new Date,operadores:null,equipamentos:null,calcularPesoQtd:!0,descricaoOperador:"",visivel:!1,item:{peso:6,quantidade:1}}},emits:["incluirApontamento"],computed:{},methods:{async show(){await this.carregarEquipamentos(),await this.carregarOperadores(),this.visivel=!0},async carregarEquipamentos(){console.log("carregar equipamentos");let i=await $db.item.leRefatorado({filtros:{tipo:"Equipamento"}});this.equipamentos=i.data.map(e=>({rotulo:e.descricao,valor:e.id}))},async carregarOperadores(){console.log("carregar operadores");let i=await $db.contato.leRefatorado({filtros:{}});this.operadores=i.data.map(e=>({rotulo:e.nome,valor:e.id}))},selecionarOperador(i,e){this.apontamento.operador=this.operadores},async concluir(){typeof this.dataIni=="string"&&(this.dataIni=new Date(this.dataIni)),typeof this.dataFim=="string"&&(this.dataFim=new Date(this.dataFim)),this.dataIni=new Date(this.dataIni),this.dataFim=new Date(this.dataFim);let i=this.dataIni.getFullYear()+"-"+("0"+(this.dataIni.getMonth()+1)).slice(-2)+"-"+("0"+this.dataIni.getDate()).slice(-2),e=this.dataFim.getFullYear()+"-"+("0"+(this.dataFim.getMonth()+1)).slice(-2)+"-"+("0"+this.dataFim.getDate()).slice(-2);if(i+="T"+this.horaIni+":00",e+="T"+this.horaFim+":00",this.apontamento.dataIni=new Date(i),this.apontamento.dataFim=new Date(e),isNaN(this.apontamento.dataIni.getTime()))return this.$q.notifyError("Data e horario de inicio invalido"),!1;if(isNaN(this.apontamento.dataFim.getTime()))return this.$q.notifyError("Data e horario de fim invalido"),!1;this.$emit("incluirApontamento",this.apontamento),this.fechar()},fechar(i){i&&i.stopPropagation(),this.$emit("update:modelValue",!1),this.apontamento={dataIni:new Date,dataFim:$utils.dataAtual(),equipamento:null,operador:null,quantidade:0,peso:0},this.dataIni=new Date,this.horaIni=new Date,this.horaFim=new Date,this.dataFim=new Date,this.dataFim=new Date,this.visivel=!1},calcularPeso(){this.calcularPesoQtd&&(this.apontamento.peso=this.apontamento.quantidade*this.item.peso)},calcularQuantidade(){this.calcularPesoQtd&&(this.apontamento.quantidade=this.apontamento.peso/this.item.peso)},async btSelecionarOperador_click(){const i=await $g.promptContato.show({filtro:{ativo:!0,operadores:!0},placeholder:"Selecione o operador"});$lodash.get(i,"id")&&(this.apontamento.operador=i.id,this.descricaoOperador=i.apelido||"")},operadorLimpar(){this.contato.idContatoOperador="",this.descricaoOperador=""}}};function y(i,e,U,Y,t,n){const d=u("campo"),r=u("g-col"),s=u("g-row");return m(),p(v,{modelValue:t.visivel,"onUpdate:modelValue":e[9]||(e[9]=l=>t.visivel=l),onKeyup:P(n.fechar,["esc"]),persistent:"",maximized:""},{default:o(()=>[a(w,{container:"",view:"hHh LpR fFf",class:"bg-light"},{default:o(()=>[a(V,null,{default:o(()=>[a(c,null,{default:o(()=>[a(f,{onClick:n.fechar,icon:"arrow_back",round:"",dense:"",flat:""},null,8,["onClick"]),a(F,null,{default:o(()=>e[10]||(e[10]=[b("Produ\xE7\xE3o de Item")])),_:1})]),_:1})]),_:1}),a(D,null,{default:o(()=>[a(I,{class:"q-pa-sm"},{default:o(()=>[a(s,{gutter:"md",bg:"bg-white",items:"center"},{default:o(()=>[a(r,{col:"12"},{default:o(()=>[a(s,{items:"center"},{default:o(()=>[a(r,{col:"12 md6"},{default:o(()=>[a(s,null,{default:o(()=>[a(r,{col:"6"},{default:o(()=>[a(d,{modelValue:t.dataIni,"onUpdate:modelValue":e[0]||(e[0]=l=>t.dataIni=l),tipo:"data",format:"DD/MM/YYYY",rotulo:"Inicio da Produ\xE7\xE3o",class:"q-mb-md"},null,8,["modelValue"])]),_:1}),a(r,{col:"6"},{default:o(()=>[a(d,{modelValue:t.horaIni,"onUpdate:modelValue":e[1]||(e[1]=l=>t.horaIni=l),tipo:"hora",format:"HH:mm:ss",rotulo:"Inicio da Produ\xE7\xE3o",class:"q-mb-md"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(r,{col:"12 md6"},{default:o(()=>[a(s,null,{default:o(()=>[a(r,{col:"6"},{default:o(()=>[a(d,{modelValue:t.dataFim,"onUpdate:modelValue":e[2]||(e[2]=l=>t.dataFim=l),tipo:"data",format:"DD/MM/YYYY",rotulo:"Fim da Produ\xE7\xE3o",class:"q-mb-md"},null,8,["modelValue"])]),_:1}),a(r,{col:"6"},{default:o(()=>[a(d,{modelValue:t.horaFim,"onUpdate:modelValue":e[3]||(e[3]=l=>t.horaFim=l),tipo:"hora",format:"HH:mm:ss",rotulo:"Fim da Produ\xE7\xE3o",class:"q-mb-md"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),a(s,{items:"center"},{default:o(()=>[a(r,{onClick:n.carregarEquipamentos,col:"12 md6"},{default:o(()=>[a(d,{modelValue:t.apontamento.equipamento,"onUpdate:modelValue":e[4]||(e[4]=l=>t.apontamento.equipamento=l),opcoes:t.equipamentos,tipo:"seletor",rotulo:"Equipamento",class:"q-mb-md"},null,8,["modelValue","opcoes"])]),_:1},8,["onClick"]),a(r,{onClick:n.carregarOperadores,col:"12 md6"},{default:o(()=>[a(_,{modelValue:t.descricaoOperador,"onUpdate:modelValue":e[5]||(e[5]=l=>t.descricaoOperador=l),onFilter:n.btSelecionarOperador_click,disable:i.podeAlterarOperador,options:["a","b"],dense:"",rounded:"",label:"Operador",class:"col-12 q-mb-md"},{append:o(()=>[t.descricaoOperador!==""?(m(),p(h,{key:0,name:"close",onClick:g(n.operadorLimpar,["stop"]),class:"cursor-pointer"},null,8,["onClick"])):Q("",!0),a(h,{onClick:g(n.btSelecionarOperador_click,["stop"]),name:"search",class:"cursor-pointer"},null,8,["onClick"])]),_:1},8,["modelValue","onFilter","disable"])]),_:1},8,["onClick"])]),_:1}),a(s,{items:"center"},{default:o(()=>[a(r,{col:"12 md4"},{default:o(()=>[a(d,{modelValue:t.apontamento.quantidade,"onUpdate:modelValue":e[6]||(e[6]=l=>t.apontamento.quantidade=l),onBlur:n.calcularPeso,tipo:"quantidade",rotulo:"Quantidade produzida",class:"q-mb-md"},null,8,["modelValue","onBlur"])]),_:1}),a(r,{col:"12 md4"},{default:o(()=>[a(d,{modelValue:t.calcularPesoQtd,"onUpdate:modelValue":e[7]||(e[7]=l=>t.calcularPesoQtd=l),tipo:"logico",rotulo:"Calcular Quantidade X Peso",class:"q-mb-md"},null,8,["modelValue"])]),_:1}),a(r,{col:"12 md4"},{default:o(()=>[a(d,{modelValue:t.apontamento.peso,"onUpdate:modelValue":e[8]||(e[8]=l=>t.apontamento.peso=l),onBlur:n.calcularQuantidade,tipo:"decimal",rotulo:"Peso em quilos",class:"q-mb-md"},null,8,["modelValue","onBlur"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(k,{class:"bg-white"},{default:o(()=>[a(c,{class:"u-container"},{default:o(()=>[a(C),a(f,{onClick:n.concluir,unelevated:"",label:"Concluir",color:"primary"},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeyup"])}var M=q(O,[["render",y]]);export{M as P};
